version: '3.8'

services:
  credit-monitor:
    build: .
    image: credit-monitor:latest
    container_name: credit-monitor
    restart: unless-stopped
    ports:
      - "8080:8080"  # Web 服务端口
      - "9100:9100"  # Prometheus Metrics 端口
    volumes:
      # 挂载配置文件（可以在宿主机修改配置）
      - ./config.json:/app/config.json
      # 挂载日志目录
      - ./logs:/app/logs
      # 挂载数据目录（数据库持久化）
      - ./data:/app/data
    env_file:
      - .env  # 从 .env 文件加载环境变量（如果文件存在）
    environment:
      - TZ=Asia/Shanghai
    # 启动 Web 服务器 + Cron 定时任务
    command: /app/start.sh
